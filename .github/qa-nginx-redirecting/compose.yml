services:
  https-proxy:
    image: nginx
    ports:
      - 8080:8080
    volumes:
      - $GITHUB_WORKSPACE/.github/qa-nginx-redirecting/nginx.conf:/etc/nginx/nginx.conf:ro
      - $GITHUB_WORKSPACE/.github/qa-nginx-redirecting/nginx.crt:/etc/nginx/nginx.crt:ro
      - $GITHUB_WORKSPACE/.github/qa-nginx-redirecting/nginx.key:/etc/nginx/nginx.key:ro
    healthcheck:
      test: ["CMD", "curl", "--fail", "--insecure", "https://localhost:8080/health"]
      interval: 10s
      timeout: 5s
      retries: 20
      start_period: 2m
